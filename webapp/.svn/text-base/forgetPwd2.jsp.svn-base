<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%
	String path = request.getContextPath();
	String basePath = request.getScheme() + "://"
			+ request.getServerName() + ":" + request.getServerPort()
			+ path + "/";
%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<base href="<%=basePath%>">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>p2p网贷平台</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<script src="<%=basePath%>libs/jquery-1.12.4.min.js" type="text/javascript" charset="utf-8"></script>
 <script type="text/javascript" src="<%=basePath%>jq/jquery.js"></script>
<link rel="stylesheet" href="<%=basePath%>css/123.css" type="text/css" media="all">
<link type="text/css" href="<%=basePath%>css/css.css" rel="stylesheet" />
<script src="<%=basePath%>js/regs.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="<%=basePath%>Jquery/jquery-1.7.2.min.js"></script>
</head>
<body>
	<h1 align="center" >富二贷公司欢迎你</h1>

	<div class="container w3layouts agileits">
		<div class="for-liucheng">
      		<div class="liulist"></div>
     		<div class="liulist for-cur"></div>
      		<div class="liulist"></div>
      		<div class="liutextbox">
       		<div class="liutext"><em>1</em><br /><strong>验证身份</strong></div>
       		<div class="liutext for-cur"><em>2</em><br /><strong>设置新密码</strong></div>
       		<div class="liutext"><em>3</em><br /><strong>完成</strong></div>
      	</div>
     </div><!--for-liucheng/-->

	    <form action="<%=basePath%>forgetPwd3.jsp" method="post" id="subtwo">
	    	<table>
	    		<tr><td><font color="white">请输入新密码：</font></td>
	    			<td><input type="password" onblur="pwd()" name="userpwd">&nbsp;&nbsp;<font id="fontPwd"></font></td></tr>
	    		<tr><td><font color="white">再次输入新密码：</font></td>
	    			<td><input type="password" onblur="pwdtwo()" name="twouserpwd">&nbsp;&nbsp;<font id="twoPadFont"></font></td></tr>
	    	</table>
         	
				<input type="button" onclick="sub()" value="确 定">
			
	    </form>
	
</div>
<script type="text/javascript">
	var	padFlag=false;
	var twoPadFlag=false;
	function pwd(){
		padFlag=false;
		if(""==$("input[name='userpwd']").val()){
			$("#fontPwd").attr({"size":3,"color":"red"}).html("密码不能为空");
			return;
		}else if($("input[name='userpwd']").val().length<6||$("input[name='userpwd']").val().length>15){
			$("#fontPwd").attr({"size":3,"color":"red"}).html("密码必须在6到15位之间");
			return;
		}else{
			$("#fontPwd").attr({"size":3,"color":"green"}).html("通过");
			padFlag=true;
		}
	}
	
	function pwdtwo(){
		twoPadFlag=false;
		if($("input[name='userpwd']").val()!=$("input[name='twouserpwd']").val()){
			$("#twoPadFont").attr({"size":3,"color":"red"}).html("两次输入的密码不一致");
			return;
		}else{
			$("#twoPadFont").attr({"size":3,"color":"green"}).html("两次密码输入一致");
			twoPadFlag=true;
		}
		
	}
	
	function sub(){
		if(padFlag && twoPadFlag){
			
			$.ajax({
		        url:"<%=basePath%>user/forgetpwd", 
		        type: "post",
		        dataType: "json",
		        data: {"userpwd":$("input[name='userpwd']").val()},
		        success: function (data) {
		            if(data.result == 'success') {
		                alert("密码修改成功！");
		                $("#subtwo").submit();
		            }else {
		                alert("密码修改失败！");		                
		            }
		        },
		        error: function (XMLHttpRequest, textStatus, errorThrown) {
		            alert("错误");
		        }
		    });				
		}else{
			alert("提交错误");
		}
	}
</script>

</body>
</html>